/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { BaseStorageService } from './base-storage.service';
import { StorageTranscoders } from './storage-transcoders';
/**
 * An implementation of `StorageService` interface that uses an underlying (web) `Storage` object, such as `localStorage` and
 * `sessionStorage`, as backing data store. This class basically wraps the `Storage` object so it can be accessed through the
 * `StorageService` interface.
 */
var /**
 * An implementation of `StorageService` interface that uses an underlying (web) `Storage` object, such as `localStorage` and
 * `sessionStorage`, as backing data store. This class basically wraps the `Storage` object so it can be accessed through the
 * `StorageService` interface.
 */
WebStorageService = /** @class */ (function (_super) {
    tslib_1.__extends(WebStorageService, _super);
    /**
     * Creates a new `WebStorageService` instance that uses the specified (web) storage object as underlying backing storage.
     *
     * @param storage Storage object which is to be wrapped in a class that implements the `StorageService` interface.
     */
    function WebStorageService(storage) {
        var _this = _super.call(this, StorageTranscoders.JSON) || this;
        _this.storage = storage;
        return _this;
    }
    /**
     * Checks whether an entry with the specified key exists in the storage.
     *
     * @param   key Identifier of the entry for which its presence in the storage is to be checked.
     * @returns     `true` if an entry with the specified key exists in the storage, `false` if not.
     */
    /**
     * Checks whether an entry with the specified key exists in the storage.
     *
     * @param {?} key Identifier of the entry for which its presence in the storage is to be checked.
     * @return {?} `true` if an entry with the specified key exists in the storage, `false` if not.
     */
    WebStorageService.prototype.has = /**
     * Checks whether an entry with the specified key exists in the storage.
     *
     * @param {?} key Identifier of the entry for which its presence in the storage is to be checked.
     * @return {?} `true` if an entry with the specified key exists in the storage, `false` if not.
     */
    function (key) {
        return this.storage.getItem(key) !== null;
    };
    /**
     * Removes the entry that is identified by the specified key. Attempting to remove an entry for an unknown key will have no effect.
     * Attempting to retrieve an entry via the `get` method after it has been removed will result in `undefined`.
     *
     * @param key Identifier of the entry which is to be removed.
     */
    /**
     * Removes the entry that is identified by the specified key. Attempting to remove an entry for an unknown key will have no effect.
     * Attempting to retrieve an entry via the `get` method after it has been removed will result in `undefined`.
     *
     * @param {?} key Identifier of the entry which is to be removed.
     * @return {?}
     */
    WebStorageService.prototype.remove = /**
     * Removes the entry that is identified by the specified key. Attempting to remove an entry for an unknown key will have no effect.
     * Attempting to retrieve an entry via the `get` method after it has been removed will result in `undefined`.
     *
     * @param {?} key Identifier of the entry which is to be removed.
     * @return {?}
     */
    function (key) {
        this.storage.removeItem(key);
    };
    /**
     * Clears the storage by removing all entries. Subsequent `get(x)` calls for a key *x* will return `undefined`, until a new value is set
     * for key *x*.
     */
    /**
     * Clears the storage by removing all entries. Subsequent `get(x)` calls for a key *x* will return `undefined`, until a new value is set
     * for key *x*.
     * @return {?}
     */
    WebStorageService.prototype.clear = /**
     * Clears the storage by removing all entries. Subsequent `get(x)` calls for a key *x* will return `undefined`, until a new value is set
     * for key *x*.
     * @return {?}
     */
    function () {
        this.storage.clear();
    };
    /**
     * Performs the actual retrieval of a value from storage.
     *
     * @param   key Identifier of the entry whose value is to be retrieved.
     * @returns     The value that is stored for the specified entry or `undefined` if no entry exists for the specified key.
     */
    /**
     * Performs the actual retrieval of a value from storage.
     *
     * @protected
     * @param {?} key Identifier of the entry whose value is to be retrieved.
     * @return {?} The value that is stored for the specified entry or `undefined` if no entry exists for the specified key.
     */
    WebStorageService.prototype.getItem = /**
     * Performs the actual retrieval of a value from storage.
     *
     * @protected
     * @param {?} key Identifier of the entry whose value is to be retrieved.
     * @return {?} The value that is stored for the specified entry or `undefined` if no entry exists for the specified key.
     */
    function (key) {
        /** @type {?} */
        var value = this.storage.getItem(key);
        return value !== null ? value : undefined;
    };
    /**
     * Stores the provided value using specified key in the storage.
     *
     * @param key   Identifier of the entry for which the value is to be stored.
     * @param value The value that is to be stored.
     */
    /**
     * Stores the provided value using specified key in the storage.
     *
     * @protected
     * @param {?} key   Identifier of the entry for which the value is to be stored.
     * @param {?} value The value that is to be stored.
     * @return {?}
     */
    WebStorageService.prototype.setItem = /**
     * Stores the provided value using specified key in the storage.
     *
     * @protected
     * @param {?} key   Identifier of the entry for which the value is to be stored.
     * @param {?} value The value that is to be stored.
     * @return {?}
     */
    function (key, value) {
        return this.storage.setItem(key, value);
    };
    return WebStorageService;
}(BaseStorageService));
/**
 * An implementation of `StorageService` interface that uses an underlying (web) `Storage` object, such as `localStorage` and
 * `sessionStorage`, as backing data store. This class basically wraps the `Storage` object so it can be accessed through the
 * `StorageService` interface.
 */
export { WebStorageService };
if (false) {
    /**
     * @type {?}
     * @private
     */
    WebStorageService.prototype.storage;
}
/**
 * Checks whether the specified (web) storage is available and functional. This might not be the case for older browsers. However even
 * certain browsers that do support the web storage API can, under some circumstances, have non functional storage objects. For example,
 * Safari is known to have `localStorage` and `sessionStorage` throw exceptions in private mode.
 *
 * @param {?} storage Storage object which is to be tested for availability.
 * @return {?} `true` if the specified storage can be used, `false` if not.
 */
export function isStorageAvailable(storage) {
    // Check if storage is available.
    if (!storage) {
        return false;
    }
    // Check if the storage can actually be accessed.
    try {
        /** @type {?} */
        var now = Date.now();
        /** @type {?} */
        var testItemKey = "storage-test-entry-" + now;
        /** @type {?} */
        var testItemValue = "storage-test-value-" + now;
        storage.setItem(testItemKey, testItemValue);
        /** @type {?} */
        var retrievedItemValue = storage.getItem(testItemKey);
        storage.removeItem(testItemKey);
        return retrievedItemValue === testItemValue;
    }
    catch (error) {
        return false;
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2ViLXN0b3JhZ2Uuc2VydmljZS5qcyIsInNvdXJjZVJvb3QiOiJuZzovL25neC13ZWJzdG9yYWdlLXNlcnZpY2UvIiwic291cmNlcyI6WyJzcmMvd2ViLXN0b3JhZ2Uuc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUFBLE9BQU8sRUFBRSxrQkFBa0IsRUFBRSxNQUFNLHdCQUF3QixDQUFDO0FBQzVELE9BQU8sRUFBRSxrQkFBa0IsRUFBRSxNQUFNLHVCQUF1QixDQUFDOzs7Ozs7QUFPM0Q7Ozs7OztJQUF1Qyw2Q0FBdUI7SUFFMUQ7Ozs7T0FJRztJQUNILDJCQUE2QixPQUFnQjtRQUE3QyxZQUNJLGtCQUFNLGtCQUFrQixDQUFDLElBQUksQ0FBQyxTQUNqQztRQUY0QixhQUFPLEdBQVAsT0FBTyxDQUFTOztJQUU3QyxDQUFDO0lBRUQ7Ozs7O09BS0c7Ozs7Ozs7SUFDSSwrQkFBRzs7Ozs7O0lBQVYsVUFBVyxHQUFXO1FBQ2xCLE9BQU8sSUFBSSxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLEtBQUssSUFBSSxDQUFDO0lBQzlDLENBQUM7SUFFRDs7Ozs7T0FLRzs7Ozs7Ozs7SUFDSSxrQ0FBTTs7Ozs7OztJQUFiLFVBQWMsR0FBVztRQUNyQixJQUFJLENBQUMsT0FBTyxDQUFDLFVBQVUsQ0FBQyxHQUFHLENBQUMsQ0FBQztJQUNqQyxDQUFDO0lBRUQ7OztPQUdHOzs7Ozs7SUFDSSxpQ0FBSzs7Ozs7SUFBWjtRQUNJLElBQUksQ0FBQyxPQUFPLENBQUMsS0FBSyxFQUFFLENBQUM7SUFDekIsQ0FBQztJQUVEOzs7OztPQUtHOzs7Ozs7OztJQUNPLG1DQUFPOzs7Ozs7O0lBQWpCLFVBQWtCLEdBQVc7O1lBQ25CLEtBQUssR0FBRyxJQUFJLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUM7UUFFdkMsT0FBTyxLQUFLLEtBQUssSUFBSSxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQztJQUM5QyxDQUFDO0lBRUQ7Ozs7O09BS0c7Ozs7Ozs7OztJQUNPLG1DQUFPOzs7Ozs7OztJQUFqQixVQUFrQixHQUFXLEVBQUUsS0FBYTtRQUN4QyxPQUFPLElBQUksQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLEdBQUcsRUFBRSxLQUFLLENBQUMsQ0FBQztJQUM1QyxDQUFDO0lBRUwsd0JBQUM7QUFBRCxDQUFDLEFBN0RELENBQXVDLGtCQUFrQixHQTZEeEQ7Ozs7Ozs7Ozs7OztJQXREZSxvQ0FBaUM7Ozs7Ozs7Ozs7QUFnRWpELE1BQU0sVUFBVSxrQkFBa0IsQ0FBQyxPQUFnQjtJQUMvQyxpQ0FBaUM7SUFDakMsSUFBSSxDQUFDLE9BQU8sRUFBRTtRQUNWLE9BQU8sS0FBSyxDQUFDO0tBQ2hCO0lBRUQsaURBQWlEO0lBQ2pELElBQUk7O1lBQ00sR0FBRyxHQUFHLElBQUksQ0FBQyxHQUFHLEVBQUU7O1lBQ2hCLFdBQVcsR0FBRyx3QkFBc0IsR0FBSzs7WUFDekMsYUFBYSxHQUFHLHdCQUFzQixHQUFLO1FBQ2pELE9BQU8sQ0FBQyxPQUFPLENBQUMsV0FBVyxFQUFFLGFBQWEsQ0FBQyxDQUFDOztZQUN0QyxrQkFBa0IsR0FBRyxPQUFPLENBQUMsT0FBTyxDQUFDLFdBQVcsQ0FBQztRQUN2RCxPQUFPLENBQUMsVUFBVSxDQUFDLFdBQVcsQ0FBQyxDQUFDO1FBRWhDLE9BQU8sa0JBQWtCLEtBQUssYUFBYSxDQUFDO0tBQy9DO0lBQUMsT0FBTyxLQUFLLEVBQUU7UUFDWixPQUFPLEtBQUssQ0FBQztLQUNoQjtBQUNMLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBCYXNlU3RvcmFnZVNlcnZpY2UgfSBmcm9tICcuL2Jhc2Utc3RvcmFnZS5zZXJ2aWNlJztcbmltcG9ydCB7IFN0b3JhZ2VUcmFuc2NvZGVycyB9IGZyb20gJy4vc3RvcmFnZS10cmFuc2NvZGVycyc7XG5cbi8qKlxuICogQW4gaW1wbGVtZW50YXRpb24gb2YgYFN0b3JhZ2VTZXJ2aWNlYCBpbnRlcmZhY2UgdGhhdCB1c2VzIGFuIHVuZGVybHlpbmcgKHdlYikgYFN0b3JhZ2VgIG9iamVjdCwgc3VjaCBhcyBgbG9jYWxTdG9yYWdlYCBhbmRcbiAqIGBzZXNzaW9uU3RvcmFnZWAsIGFzIGJhY2tpbmcgZGF0YSBzdG9yZS4gVGhpcyBjbGFzcyBiYXNpY2FsbHkgd3JhcHMgdGhlIGBTdG9yYWdlYCBvYmplY3Qgc28gaXQgY2FuIGJlIGFjY2Vzc2VkIHRocm91Z2ggdGhlXG4gKiBgU3RvcmFnZVNlcnZpY2VgIGludGVyZmFjZS5cbiAqL1xuZXhwb3J0IGNsYXNzIFdlYlN0b3JhZ2VTZXJ2aWNlIGV4dGVuZHMgQmFzZVN0b3JhZ2VTZXJ2aWNlPGFueT4ge1xuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIG5ldyBgV2ViU3RvcmFnZVNlcnZpY2VgIGluc3RhbmNlIHRoYXQgdXNlcyB0aGUgc3BlY2lmaWVkICh3ZWIpIHN0b3JhZ2Ugb2JqZWN0IGFzIHVuZGVybHlpbmcgYmFja2luZyBzdG9yYWdlLlxuICAgICAqXG4gICAgICogQHBhcmFtIHN0b3JhZ2UgU3RvcmFnZSBvYmplY3Qgd2hpY2ggaXMgdG8gYmUgd3JhcHBlZCBpbiBhIGNsYXNzIHRoYXQgaW1wbGVtZW50cyB0aGUgYFN0b3JhZ2VTZXJ2aWNlYCBpbnRlcmZhY2UuXG4gICAgICovXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSByZWFkb25seSBzdG9yYWdlOiBTdG9yYWdlKSB7XG4gICAgICAgIHN1cGVyKFN0b3JhZ2VUcmFuc2NvZGVycy5KU09OKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDaGVja3Mgd2hldGhlciBhbiBlbnRyeSB3aXRoIHRoZSBzcGVjaWZpZWQga2V5IGV4aXN0cyBpbiB0aGUgc3RvcmFnZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSAgIGtleSBJZGVudGlmaWVyIG9mIHRoZSBlbnRyeSBmb3Igd2hpY2ggaXRzIHByZXNlbmNlIGluIHRoZSBzdG9yYWdlIGlzIHRvIGJlIGNoZWNrZWQuXG4gICAgICogQHJldHVybnMgICAgIGB0cnVlYCBpZiBhbiBlbnRyeSB3aXRoIHRoZSBzcGVjaWZpZWQga2V5IGV4aXN0cyBpbiB0aGUgc3RvcmFnZSwgYGZhbHNlYCBpZiBub3QuXG4gICAgICovXG4gICAgcHVibGljIGhhcyhrZXk6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gdGhpcy5zdG9yYWdlLmdldEl0ZW0oa2V5KSAhPT0gbnVsbDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZW1vdmVzIHRoZSBlbnRyeSB0aGF0IGlzIGlkZW50aWZpZWQgYnkgdGhlIHNwZWNpZmllZCBrZXkuIEF0dGVtcHRpbmcgdG8gcmVtb3ZlIGFuIGVudHJ5IGZvciBhbiB1bmtub3duIGtleSB3aWxsIGhhdmUgbm8gZWZmZWN0LlxuICAgICAqIEF0dGVtcHRpbmcgdG8gcmV0cmlldmUgYW4gZW50cnkgdmlhIHRoZSBgZ2V0YCBtZXRob2QgYWZ0ZXIgaXQgaGFzIGJlZW4gcmVtb3ZlZCB3aWxsIHJlc3VsdCBpbiBgdW5kZWZpbmVkYC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBrZXkgSWRlbnRpZmllciBvZiB0aGUgZW50cnkgd2hpY2ggaXMgdG8gYmUgcmVtb3ZlZC5cbiAgICAgKi9cbiAgICBwdWJsaWMgcmVtb3ZlKGtleTogc3RyaW5nKTogdm9pZCB7XG4gICAgICAgIHRoaXMuc3RvcmFnZS5yZW1vdmVJdGVtKGtleSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2xlYXJzIHRoZSBzdG9yYWdlIGJ5IHJlbW92aW5nIGFsbCBlbnRyaWVzLiBTdWJzZXF1ZW50IGBnZXQoeClgIGNhbGxzIGZvciBhIGtleSAqeCogd2lsbCByZXR1cm4gYHVuZGVmaW5lZGAsIHVudGlsIGEgbmV3IHZhbHVlIGlzIHNldFxuICAgICAqIGZvciBrZXkgKngqLlxuICAgICAqL1xuICAgIHB1YmxpYyBjbGVhcigpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5zdG9yYWdlLmNsZWFyKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUGVyZm9ybXMgdGhlIGFjdHVhbCByZXRyaWV2YWwgb2YgYSB2YWx1ZSBmcm9tIHN0b3JhZ2UuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gICBrZXkgSWRlbnRpZmllciBvZiB0aGUgZW50cnkgd2hvc2UgdmFsdWUgaXMgdG8gYmUgcmV0cmlldmVkLlxuICAgICAqIEByZXR1cm5zICAgICBUaGUgdmFsdWUgdGhhdCBpcyBzdG9yZWQgZm9yIHRoZSBzcGVjaWZpZWQgZW50cnkgb3IgYHVuZGVmaW5lZGAgaWYgbm8gZW50cnkgZXhpc3RzIGZvciB0aGUgc3BlY2lmaWVkIGtleS5cbiAgICAgKi9cbiAgICBwcm90ZWN0ZWQgZ2V0SXRlbShrZXk6IHN0cmluZyk6IHN0cmluZyB8IHVuZGVmaW5lZCB7XG4gICAgICAgIGNvbnN0IHZhbHVlID0gdGhpcy5zdG9yYWdlLmdldEl0ZW0oa2V5KTtcblxuICAgICAgICByZXR1cm4gdmFsdWUgIT09IG51bGwgPyB2YWx1ZSA6IHVuZGVmaW5lZDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTdG9yZXMgdGhlIHByb3ZpZGVkIHZhbHVlIHVzaW5nIHNwZWNpZmllZCBrZXkgaW4gdGhlIHN0b3JhZ2UuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ga2V5ICAgSWRlbnRpZmllciBvZiB0aGUgZW50cnkgZm9yIHdoaWNoIHRoZSB2YWx1ZSBpcyB0byBiZSBzdG9yZWQuXG4gICAgICogQHBhcmFtIHZhbHVlIFRoZSB2YWx1ZSB0aGF0IGlzIHRvIGJlIHN0b3JlZC5cbiAgICAgKi9cbiAgICBwcm90ZWN0ZWQgc2V0SXRlbShrZXk6IHN0cmluZywgdmFsdWU6IHN0cmluZyk6IHZvaWQge1xuICAgICAgICByZXR1cm4gdGhpcy5zdG9yYWdlLnNldEl0ZW0oa2V5LCB2YWx1ZSk7XG4gICAgfVxuXG59XG5cbi8qKlxuICogQ2hlY2tzIHdoZXRoZXIgdGhlIHNwZWNpZmllZCAod2ViKSBzdG9yYWdlIGlzIGF2YWlsYWJsZSBhbmQgZnVuY3Rpb25hbC4gVGhpcyBtaWdodCBub3QgYmUgdGhlIGNhc2UgZm9yIG9sZGVyIGJyb3dzZXJzLiBIb3dldmVyIGV2ZW5cbiAqIGNlcnRhaW4gYnJvd3NlcnMgdGhhdCBkbyBzdXBwb3J0IHRoZSB3ZWIgc3RvcmFnZSBBUEkgY2FuLCB1bmRlciBzb21lIGNpcmN1bXN0YW5jZXMsIGhhdmUgbm9uIGZ1bmN0aW9uYWwgc3RvcmFnZSBvYmplY3RzLiBGb3IgZXhhbXBsZSxcbiAqIFNhZmFyaSBpcyBrbm93biB0byBoYXZlIGBsb2NhbFN0b3JhZ2VgIGFuZCBgc2Vzc2lvblN0b3JhZ2VgIHRocm93IGV4Y2VwdGlvbnMgaW4gcHJpdmF0ZSBtb2RlLlxuICpcbiAqIEBwYXJhbSAgIHN0b3JhZ2UgU3RvcmFnZSBvYmplY3Qgd2hpY2ggaXMgdG8gYmUgdGVzdGVkIGZvciBhdmFpbGFiaWxpdHkuXG4gKiBAcmV0dXJucyAgICAgICAgIGB0cnVlYCBpZiB0aGUgc3BlY2lmaWVkIHN0b3JhZ2UgY2FuIGJlIHVzZWQsIGBmYWxzZWAgaWYgbm90LlxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNTdG9yYWdlQXZhaWxhYmxlKHN0b3JhZ2U6IFN0b3JhZ2UpOiBib29sZWFuIHtcbiAgICAvLyBDaGVjayBpZiBzdG9yYWdlIGlzIGF2YWlsYWJsZS5cbiAgICBpZiAoIXN0b3JhZ2UpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIC8vIENoZWNrIGlmIHRoZSBzdG9yYWdlIGNhbiBhY3R1YWxseSBiZSBhY2Nlc3NlZC5cbiAgICB0cnkge1xuICAgICAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xuICAgICAgICBjb25zdCB0ZXN0SXRlbUtleSA9IGBzdG9yYWdlLXRlc3QtZW50cnktJHtub3d9YDtcbiAgICAgICAgY29uc3QgdGVzdEl0ZW1WYWx1ZSA9IGBzdG9yYWdlLXRlc3QtdmFsdWUtJHtub3d9YDtcbiAgICAgICAgc3RvcmFnZS5zZXRJdGVtKHRlc3RJdGVtS2V5LCB0ZXN0SXRlbVZhbHVlKTtcbiAgICAgICAgY29uc3QgcmV0cmlldmVkSXRlbVZhbHVlID0gc3RvcmFnZS5nZXRJdGVtKHRlc3RJdGVtS2V5KTtcbiAgICAgICAgc3RvcmFnZS5yZW1vdmVJdGVtKHRlc3RJdGVtS2V5KTtcblxuICAgICAgICByZXR1cm4gcmV0cmlldmVkSXRlbVZhbHVlID09PSB0ZXN0SXRlbVZhbHVlO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG59XG4iXX0=